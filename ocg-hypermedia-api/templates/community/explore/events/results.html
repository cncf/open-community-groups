{% import "common.html" as common %}

{% set view_mode = self.view_mode.clone().unwrap_or_default() %}

{% match view_mode %}
  {% when ViewMode::Calendar %}
    <!-- Calendar view -->
    <div class="mt-5 border-t border-gray-100 md:mt-7 p-6">
      <div class="flex justify-between items-center mb-5 h-16">
        <div id="calendar-date" class="text-xl font-semibold text-gray-700 md:text-2xl lg:text-[2rem]"></div>
        <div class="flex">
          <!-- Today button -->
          {% call common::secondary_mini_button("Today", "loadCurrentMonth('events')", "") %}

          <!-- Next/Prev buttons -->
          <div class="inline-flex ml-4" role="group">
            <button type="button" class="cursor-pointer inline-flex items-center pr-4 pl-3 py-1 text-xs font-medium text-primary-500 bg-transparent border border-primary-500 rounded-s-full hover:bg-primary-500 hover:text-white focus:z-10 focus:ring-2 focus:ring-primary-300 focus:bg-primary-500 focus:text-white" onclick="loadPrevMonth('events')">
              <svg class="h-5 w-5" stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 24 24" height="1em" width="1em" xmlns="http://www.w3.org/2000/svg"><path fill="none" d="M0 0h24v24H0V0z"></path><path d="M15.41 16.59 10.83 12l4.58-4.59L14 6l-6 6 6 6 1.41-1.41z"></path></svg>
            </button>
            <button type="button" class="cursor-pointer inline-flex items-center -ml-[1px] pl-4 pr-3 py-1 text-xs font-medium text-primary-500 bg-transparent border border-primary-500 rounded-e-full hover:bg-primary-500 hover:text-white focus:z-10 focus:ring-2 focus:ring-primary-300 focus:bg-primary-500 focus:text-white" onclick="loadNextMonth('events')">
              <svg class="h-5 w-5" stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 24 24" height="1em" width="1em" xmlns="http://www.w3.org/2000/svg"><path fill="none" d="M0 0h24v24H0V0z"></path><path d="M8.59 16.59 13.17 12 8.59 7.41 10 6l6 6-6 6-1.41-1.41z"></path></svg>
            </button>
          </div>
        </div>
      </div>

      <div id="calendar-box" class="fc fc-media-screen fc-direction-ltr fc-theme-standard"></div>
    </div>
    <script>loadCalendar('events');</script>
    <!-- End calendar view -->

  {% when ViewMode::List %}
    <!-- List view -->
    <div class="flex flex-col divide-y mt-5 border-t border-gray-100 md:mt-7 {% if events.len() > 0 %}border-b{% endif %}" hx-on::load="updateResults('{% call common::current_page(total, events.len(), offset) %}')">
      <!-- Placeholder cards -->
      {% if events.len() == 0 %}
        {% call common::alert("We're sorry!", "We can't seem to find any events that match your search criteria. You can reset your filters or try a different search.") %}
      {% endif %}
      <!-- End placeholder cards -->

      <!-- Cards -->
      {% for event in events %}
        {{ event|safe }}
      {% endfor %}
      <!-- End cards -->
    </div>

    <!-- Pagination -->
    {% if events.len() > 0 %}
      {{ navigation_links|safe }}
    {% endif %}
    <!-- End pagination -->
    <!-- End list view -->

  {% when ViewMode::Map %}
    <!-- Map view -->
    <div class="mt-5 border-t border-gray-100 md:mt-7 p-6">
      <div class="relative w-full border h-[600px] md:h-[820px]">
        <div id="map-box" class="w-full h-full"></div>
        <div class="hidden absolute z-[1000] top-0 bottom-0 left-0 w-[40%] md:block">
          <div id="map-content" class="w-full max-h-full overflow-auto"></div>
        </div>
      </div>
    </div>
    <script>loadMap('events');</script>
    <!-- End map view -->

  {% else %}
    <div>Not available view mode</div>
{% endmatch %}
