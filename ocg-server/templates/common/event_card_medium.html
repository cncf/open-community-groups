{% import "common.html" as common -%}

{# Event card -#}
<a href="/group/{{ event.group_slug }}/event/{{ event.slug }}"
   hx-boost="true">
  <div class="flex flex-1 flex-row items-stretch">
    {# Event icon -#}
    <div class="card-logo">
      {% call common::logo(logo_url = event.logo_url, classes = "hidden md:block h-[140px] w-[140px] min-w-[140px]", size = 140, color = event.group_color, name = Some(event.group_name)) -%}
      {% call common::logo(logo_url = event.logo_url, classes = "block h-14 w-14 min-w-14 md:hidden", size = 60, color = event.group_color) -%}
    </div>
    {# End event icon -#}

    <div class="min-w-0 pl-4 content-center">
      <div class="flex flex-col justify-between h-full">
        <div>
          {# Event group name -#}
          <div class="card-header">
            <span>{{ event.group_name }}</span>
          </div>
          {# End event group name -#}

          {# Event name -#}
          <div class="line-clamp-2 text-[0.9rem] md:text-base font-semibold md:mt-1 md:line-clamp-1">
            {{ event.name|demoji }}
          </div>
          {# End event name -#}
        </div>

        {# Event description on desktop -#}
        {% if let Some(description_short) = event.description_short -%}
          <div class="hidden h-[36px] md:my-2 md:block">
            <p class="text-[0.8rem] text-stone-500 leading-[1.2rem] line-clamp-2">{{ description_short|demoji }}</p>
          </div>
        {% endif -%}
        {# End event description on desktop -#}

        <div class="hidden md:block">
          {# Event location -#}
          <div class="card-meta h-[28px]">
            {% if event.kind != EventKind::Virtual -%}
              {% if let Some(location) = self.event.location(36) -%}
                <div class="hidden truncate me-2 xl:block">
                  {% call common::icon_text(icon_name = "location", text = self.event.location(57).expect("location to exist")) -%}
                </div>
                <div class="block truncate me-2 xl:hidden">
                  {% call common::icon_text(icon_name = "location", text = location) -%}
                </div>
              {% endif -%}
            {% else -%}
              <div class="icon-text me-2">
                <div class="svg-icon w-3 h-3 bg-stone-700 icon-location"></div>
              </div>
            {% endif -%}
            {% call common::event_badge(kind = event.kind) -%}
          </div>
          {# End event location -#}

          {# Event date -#}
          <div class="flex items-center pt-0.5">
            {% if let Some(starts_at) = event.starts_at -%}
              {% call common::icon_text(icon_name = "date", text = starts_at.with_timezone(event.timezone).format("%A, %B %e, %G · %I:%M %p %Z")) -%}
            {% endif -%}
            {% if event.canceled -%}
              {% call common::event_badge(kind = event.kind, canceled = true, extra_styles = Some("ms-3")) -%}
            {% endif -%}
          </div>
          {# End event date -#}
        </div>
      </div>
    </div>
  </div>

  {# Mobile content -#}
  <div class="block md:hidden">
    {# Event location -#}
    <div class="card-meta mt-3 h-[21px]">
      {% if event.kind != EventKind::Virtual -%}
        {% if let Some(location) = self.event.location(25) -%}
          {% call common::icon_text(icon_name = "location", text = location, extra_styles = Some("me-2")) -%}
        {% endif -%}
      {% else -%}
        <div class="icon-text me-2">
          <div class="svg-icon w-3 h-3 bg-stone-700 icon-location"></div>
        </div>
      {% endif -%}
      {% call common::event_badge(kind = event.kind) -%}
    </div>
    {# End event location -#}

    {# Event date -#}
    <div class="flex items-center pt-1">
      {% if let Some(starts_at) = event.starts_at -%}
        {% call common::icon_text(icon_name = "date", text = starts_at.with_timezone(event.timezone).format("%A, %B %e, %G · %I:%M %p %Z")) -%}
      {% endif -%}
      {% if event.canceled -%}
        {% call common::event_badge(kind = event.kind, canceled = true, extra_styles = Some("ms-3")) -%}
      {% endif -%}
    </div>
    {# End event date -#}
  </div>
  {# End mobile content -#}

  {# Description -#}
  {% if let Some(description_short) = event.description_short -%}
    <div class="block md:hidden">
      <p class="text-xs text-stone-500 leading-[1.2rem] line-clamp-2 mt-3">{{ description_short|demoji }}</p>
    </div>
  {% endif -%}
  {# End description -#}
</a>
{# End event card -#}
