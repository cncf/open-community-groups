{% import "common.html" as common -%}

{# Header -#}
<header id="header">
  {# Navigation bar -#}
  <nav class="flex items-center justify-between p-4 sm:p-6 lg:p-8">
    {# Logo -#}
    <div class="flex lg:flex-1">
      {% if path != "/" %}<a href="/">{% endif %}
        <div class="-m-1.5 p-1.5">
          <img class="h-10 w-50"
               width="208"
               height="40"
               src="{{ self.community.header_logo_url }}"
               alt="Logo" />
        </div>
        {% if path != "/" %}</a>{% endif %}
    </div>
    {# End logo -#}

    {# Mobile menu button -#}
    <div class="flex lg:hidden">
      <button id="open-navbar-mobile"
              type="button"
              class="-m-2.5 inline-flex items-center justify-center rounded-md p-2.5">
        <span class="sr-only">Open main menu</span>
        <div class="svg-icon h-6 w-6 bg-gray-700 icon-lines"></div>
      </button>
    </div>
    {# End mobile menu button -#}

    {# Desktop links -#}
    <div class="hidden lg:flex lg:gap-x-8">
      {% call link(content = "Home", href = "/", current_path = path) -%}
      {% call link(content = "Explore", href = "/explore", current_path = path) -%}
      {% if let Some(new_group_details) = self.community.new_group_details -%}
        {% call button(id = "open-new-group-btn", content = "New group") -%}
        <script type="module">
          import {
            toggleModalVisibility
          } from '/static/js/common/common.js';

          const openNewGroupBtn = document.getElementById('open-new-group-btn');
          if (openNewGroupBtn) {
            openNewGroupBtn.addEventListener('click', () => toggleModalVisibility('new-group-modal'));
          }
        </script>
      {% endif -%}
    </div>
    {# End desktop links -#}

    {# Desktop buttons -#}
    <div class="hidden lg:flex lg:flex-1 lg:justify-end space-x-4">
      {% call common::secondary_button(id = "signup-btn", content = "Sign up", rounded = false, disabled = true) -%}
      {% call common::primary_button(id = "login-btn", content = "Log in", rounded = false, disabled = true) -%}
    </div>
    {# End desktop buttons -#}
  </nav>
  {# End navigation bar -#}

  {# Mobile menu -#}
  <div class="hidden lg:hidden"
       role="dialog"
       aria-modal="true"
       id="navbar-mobile">
    <div class="hidden fixed inset-0 z-20" id="backdrop-backdrop"></div>
    <div class="fixed inset-y-0 right-0 z-20 w-full overflow-y-auto bg-white px-6 py-6 sm:max-w-sm sm:ring-1 sm:ring-gray-900/10">
      <div class="flex items-center justify-between">
        {# Close menu button -#}
        <button id="close-navbar-mobile"
                type="button"
                class="-m-2.5 rounded-md p-2.5">
          <span class="sr-only">Close menu</span>
          <div class="svg-icon h-6 w-6 bg-gray-700 icon-close"></div>
        </button>
        {# End close menu button -#}
      </div>
      <div class="mt-6 flow-root">
        <div class="-my-6 divide-y divide-gray-500/10">
          {# Mobile links -#}
          <div class="space-y-2 py-6">
            {% call mobile_link(content = "Home", href = "/") -%}
            {% call mobile_link(content = "Explore", href = "/explore") -%}
            {% call mobile_button(content = "New group", id = "open-new-group-mobile-btn") -%}
            <script type="module">
              import {
                toggleMobileNavbarVisibility,
                toggleModalVisibility
              } from '/static/js/common/common.js';

              const openNewGroupMobileBtn = document.getElementById('open-new-group-mobile-btn');
              if (openNewGroupMobileBtn) {
                openNewGroupMobileBtn.addEventListener('click', () => {
                  toggleModalVisibility('new-group-modal')
                  toggleMobileNavbarVisibility();
                });
              }
            </script>
          </div>
          {# End mobile links -#}

          {# Mobile buttons - Sign up / Log in -#}
          <div class="py-6">
            {% call mobile_link(content = "Sign up", href = "#") -%}
            {% call mobile_link(content = "Login in", href = "#") -%}
          </div>
          {# End mobile buttons - Sign up / Log in -#}
        </div>
      </div>
    </div>
  </div>
  {# End mobile menu -#}
</header>
{# End header -#}

<script type="module">
  import {
    toggleMobileNavbarVisibility
  } from '/static/js/common/common.js';

  const openNavbarMobile = document.getElementById('open-navbar-mobile');
  if (openNavbarMobile) {
    openNavbarMobile.addEventListener('click', toggleMobileNavbarVisibility);
  }

  const closeNavbarMobileBtn = document.getElementById('close-navbar-mobile');
  if (closeNavbarMobileBtn) {
    closeNavbarMobileBtn.addEventListener('click', toggleMobileNavbarVisibility);
  }
</script>

{# New group modal -#}
{% if let Some(new_group_details) = self.community.new_group_details -%}
  <div id="new-group-modal"
       tabindex="-1"
       aria-hidden="true"
       class="hidden overflow-y-auto overflow-x-hidden fixed top-0 right-0 left-0 z-50 justify-center items-center w-full md:inset-0 h-full max-h-full flex">
    <div id="backdrop-new-group-modal"
         class="modal-overlay absolute w-full h-full bg-black opacity-75"></div>
    <div class="relative p-4 w-full max-w-2xl max-h-full">
      <div class="relative bg-white rounded-lg shadow">
        {# Modal header -#}
        <div class="flex items-center justify-between p-4 md:p-5 border-b rounded-t">
          {# Title -#}
          <h3 class="text-xl font-semibold text-gray-900">New group</h3>
          {# End title -#}

          {# Close button -#}
          <button id="close-new-group-modal"
                  type="button"
                  class="group bg-transparent hover:bg-gray-200 rounded-lg text-sm w-8 h-8 ms-auto inline-flex justify-center items-center">
            <div class="svg-icon h-5 w-5 bg-gray-400 grouphover:bg-gray-900 icon-close"></div>
            <span class="sr-only">Close modal</span>
          </button>
          {# End close button -#}
        </div>
        {# End modal header -#}

        {# Modal content -#}
        <div class="new-group-content p-4 md:p-8">{{ new_group_details|safe }}</div>
        {# End modal content -#}
      </div>
    </div>
  </div>
  <script type="module">
    import {
      toggleModalVisibility
    } from '/static/js/common/common.js';

    const backdropNewGroupModal = document.getElementById('backdrop-new-group-modal');
    if (backdropNewGroupModal) {
      backdropNewGroupModal.addEventListener('click', () => toggleModalVisibility('new-group-modal'));
    }

    const closeNewGroupModal = document.getElementById('close-new-group-modal');
    if (closeNewGroupModal) {
      closeNewGroupModal.addEventListener('click', () => toggleModalVisibility('new-group-modal'));
    }
  </script>
{% endif -%}
{# End new group modal -#}

{# Link -#}
{% macro link(content, href, current_path, extra_styles = None) -%}
  {% let extra_styles_ = extra_styles.unwrap_or("") -%}

  <a href="{{ href }}"
     class="mx-3 pb-1 border-0 border-primary-500 text-lg font-semibold tracking-widest text-primary-500 uppercase {%+ if current_path == href %} border-b-2 {%- else %} hover:border-b-2 hover:border-primary-300 {%- endif %} {{ extra_styles_ }}">{{ content }}</a>
{% endmacro link -%}
{# End link -#}

{# Button -#}
{% macro button(id, content, extra_styles = None) -%}
  {% let extra_styles_ = extra_styles.unwrap_or("") -%}

  <button id="{{ id }}"
          class="mx-3 pb-1 border-b-2 border-transparent text-lg font-semibold tracking-widest text-primary-500 uppercase hover:border-primary-300 {{ extra_styles_ }}">
    {{ content }}
  </button>
{% endmacro button -%}
{# End button -#}

{# Mobile link -#}
{% macro mobile_link(content, href, extra_styles = None) -%}
  {% let extra_styles_ = extra_styles.unwrap_or("") -%}

  <a href="{{ href }}"
     class="-mx-3 block rounded-lg px-3 py-2 text-base font-semibold leading-7 text-gray-900 hover:bg-gray-50 {{ extra_styles_ }}">
    {{ content }}
  </a>
{% endmacro mobile_link -%}
{# End mobile link -#}

{# Mobile button -#}
{% macro mobile_button(content, id, extra_styles = None) -%}
  {% let extra_styles_ = extra_styles.unwrap_or("") -%}

  <button id="{{ id }}"
          class="-mx-3 block rounded-lg px-3 py-2 text-base font-semibold leading-7 text-gray-900 hover:bg-gray-50 {{ extra_styles_ }}">
    {{ content }}
  </button>
{% endmacro mobile_button -%}
{# End mobile button -#}
