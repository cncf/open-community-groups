{# Menu title -#}
{% macro menu_title(text, extra_styles = "") -%}
  <div class="text-xs/6 text-stone-500 uppercase px-3 {{ extra_styles }}">{{ text }}</div>
{% endmacro menu_title -%}
{# End menu title -#}

{# Menu item -#}
{% macro menu_item(name, icon, is_active, href, disabled = false, extra_styles = "", icon_size = "size-4", items_count = 0 ) -%}
  {% if is_active -%}
    <div class="relative bg-white border border-stone-200 px-3 rounded-lg {{ extra_styles }}">
      <a hx-get="{{ href }}"
         hx-target="body"
         hx-indicator="#dashboard-spinner"
         hx-push-url="true"
         class="flex items-center justify-between cursor-pointer"
         aria-current="page">
        <div class="flex items-center">
          <div class="svg-icon {{ icon_size }} icon-{{ icon }} bg-primary-500"></div>
          <div class="text-sm/8 ms-3">{{ name }}</div>
        </div>
        {% if items_count + 0 > 0 -%}
          <div class="text-[0.65rem]/4 font-bold text-primary-500 border border-primary-500 bg-white rounded-full px-2 pt-0.25 ms-3">
            {{ items_count }}
          </div>
        {% endif -%}
      </a>
      <div class="absolute top-0.5 -left-3 lg:-left-5 bottom-0.5 w-1 bg-primary-500 rounded-lg"></div>
    </div>
  {% else -%}
    {% if disabled -%}
      <button class="rounded-md px-3 border border-transparent cursor-not-allowed {{ extra_styles }} py-2"
              disabled
              aria-disabled="true"
              title="Coming soon!"
              aria-label="{{ name }} - Coming soon">
        <div class="flex items-center opacity-50">
          <div class="svg-icon {{ icon_size }} icon-{{ icon }} bg-stone-500"></div>
          <div class="text-sm/8 ms-3 text-stone-500">{{ name }}</div>
        </div>
      </button>
    {% else -%}
      <div class="rounded-md px-3 border border-transparent hover:bg-white hover:border-stone-200 transition-colors {{ extra_styles }}">
        <a hx-get="{{ href }}"
           hx-target="body"
           hx-indicator="#dashboard-spinner"
           hx-push-url="true"
           class="flex items-center justify-between cursor-pointer">
          <div class="flex items-center">
            <div class="svg-icon {{ icon_size }} icon-{{ icon }} bg-primary-500"></div>
            <div class="text-sm/8 ms-3">{{ name }}</div>
          </div>
          {% if items_count + 0 > 0 -%}
            <div class="text-[0.65rem]/4 font-bold text-primary-500 border border-primary-500 bg-white rounded-full px-2 pt-0.25 ms-3">
              {{ items_count }}
            </div>
          {% endif -%}
        </a>
      </div>
    {% endif -%}
  {% endif -%}
{% endmacro menu_item -%}
{# End menu item -#}

{# Form title #}
{% macro form_title(title, description = "", button = "") -%}
  <div>
    <div class="text-xl lg:text-2xl font-medium text-stone-900">{{ title }}</div>
    {% if !description.is_empty() -%}
      <div class="mt-1 flex flex-wrap items-center gap-3">
        <p class="text-sm/6 text-stone-500 m-0">{{ description }}</p>
        {% if !button.is_empty() -%}
          {{ button | safe }}
        {% endif -%}
      </div>
    {% elif !button.is_empty() -%}
      <div class="mt-1">{{ button | safe }}</div>
    {% endif -%}
  </div>
{% endmacro form_title -%}
{# End form title #}

{# Group analytics chart container #}
{% macro group_analytics_chart(chart_id, data, min_points = 0) -%}
  {% if data.len() > min_points + 0 -%}
    <div id="{{ chart_id }}" class="h-[320px]">
      <svg-spinner size="size-10" class="flex items-center justify-center h-full text-gray-500">
      </svg-spinner>
    </div>
  {%- else -%}
    <div class="chart-empty-state">No data available yet</div>
  {%- endif %}
{% endmacro group_analytics_chart -%}
{# End group analytics chart container #}

{# Community analytics chart container #}
{% macro community_analytics_chart(chart_id, class = "h-[320px]") -%}
  <div id="{{ chart_id }}" class="{{ class }}">
    <svg-spinner size="size-10" class="flex items-center justify-center h-full text-gray-500">
    </svg-spinner>
  </div>
{% endmacro community_analytics_chart -%}
{# End community analytics chart container #}

{# Pagination controls #}
{% macro pagination(current_page, total_pages, base_url, hx_target = "#dashboard-content") -%}
  {% if total_pages > 1 -%}
    <div class="flex items-center justify-between border-t border-stone-200 bg-white px-4 py-3 sm:px-6 mt-6">
      <div class="flex flex-1 justify-between sm:hidden">
        {% if current_page > 1 -%}
          <a href="{{ base_url }}&page={{ current_page - 1 }}"
             hx-get="{{ base_url }}&page={{ current_page - 1 }}"
             hx-target="{{ hx_target }}"
             hx-indicator="#dashboard-spinner"
             class="relative inline-flex items-center rounded-md border border-stone-300 bg-white px-4 py-2 text-sm font-medium text-stone-700 hover:bg-stone-50">
            Previous
          </a>
        {% else -%}
          <span class="relative inline-flex items-center rounded-md border border-stone-200 bg-stone-50 px-4 py-2 text-sm font-medium text-stone-400 cursor-not-allowed">
            Previous
          </span>
        {% endif -%}
        {% if current_page < total_pages -%}
          <a href="{{ base_url }}&page={{ current_page + 1 }}"
             hx-get="{{ base_url }}&page={{ current_page + 1 }}"
             hx-target="{{ hx_target }}"
             hx-indicator="#dashboard-spinner"
             class="relative ml-3 inline-flex items-center rounded-md border border-stone-300 bg-white px-4 py-2 text-sm font-medium text-stone-700 hover:bg-stone-50">
            Next
          </a>
        {% else -%}
          <span class="relative ml-3 inline-flex items-center rounded-md border border-stone-200 bg-stone-50 px-4 py-2 text-sm font-medium text-stone-400 cursor-not-allowed">
            Next
          </span>
        {% endif -%}
      </div>
      <div class="hidden sm:flex sm:flex-1 sm:items-center sm:justify-between">
        <div>
          <p class="text-sm text-stone-700">
            Page
            <span class="font-medium">{{ current_page }}</span>
            of
            <span class="font-medium">{{ total_pages }}</span>
          </p>
        </div>
        <div>
          <nav class="isolate inline-flex -space-x-px rounded-md shadow-sm" aria-label="Pagination">
            {% if current_page > 1 -%}
              <a href="{{ base_url }}&page={{ current_page - 1 }}"
                 hx-get="{{ base_url }}&page={{ current_page - 1 }}"
                 hx-target="{{ hx_target }}"
                 hx-indicator="#dashboard-spinner"
                 class="relative inline-flex items-center rounded-l-md px-2 py-2 text-stone-400 ring-1 ring-inset ring-stone-300 hover:bg-stone-50 focus:z-20 focus:outline-offset-0">
                <span class="sr-only">Previous</span>
                <svg class="h-5 w-5" viewBox="0 0 20 20" fill="currentColor" aria-hidden="true">
                  <path fill-rule="evenodd" d="M12.79 5.23a.75.75 0 01-.02 1.06L8.832 10l3.938 3.71a.75.75 0 11-1.04 1.08l-4.5-4.25a.75.75 0 010-1.08l4.5-4.25a.75.75 0 011.06.02z" clip-rule="evenodd" />
                </svg>
              </a>
            {% else -%}
              <span class="relative inline-flex items-center rounded-l-md px-2 py-2 text-stone-300 ring-1 ring-inset ring-stone-200 bg-stone-50 cursor-not-allowed">
                <span class="sr-only">Previous</span>
                <svg class="h-5 w-5" viewBox="0 0 20 20" fill="currentColor" aria-hidden="true">
                  <path fill-rule="evenodd" d="M12.79 5.23a.75.75 0 01-.02 1.06L8.832 10l3.938 3.71a.75.75 0 11-1.04 1.08l-4.5-4.25a.75.75 0 010-1.08l4.5-4.25a.75.75 0 011.06.02z" clip-rule="evenodd" />
                </svg>
              </span>
            {% endif -%}

            {% let start_page = (current_page - 2)|max_value(1) -%}
            {% let end_page = (current_page + 2)|min_value(total_pages) -%}
            
            {% if start_page > 1 -%}
              <a href="{{ base_url }}&page=1"
                 hx-get="{{ base_url }}&page=1"
                 hx-target="{{ hx_target }}"
                 hx-indicator="#dashboard-spinner"
                 class="relative inline-flex items-center px-4 py-2 text-sm font-semibold text-stone-900 ring-1 ring-inset ring-stone-300 hover:bg-stone-50 focus:z-20 focus:outline-offset-0">
                1
              </a>
              {% if start_page > 2 -%}
                <span class="relative inline-flex items-center px-4 py-2 text-sm font-semibold text-stone-700 ring-1 ring-inset ring-stone-300">...</span>
              {% endif -%}
            {% endif -%}

            {% for page in start_page..=end_page -%}
              {% if page == current_page -%}
                <span aria-current="page" class="relative z-10 inline-flex items-center bg-primary-500 px-4 py-2 text-sm font-semibold text-white focus:z-20 focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-2 focus-visible:outline-primary-500">
                  {{ page }}
                </span>
              {% else -%}
                <a href="{{ base_url }}&page={{ page }}"
                   hx-get="{{ base_url }}&page={{ page }}"
                   hx-target="{{ hx_target }}"
                   hx-indicator="#dashboard-spinner"
                   class="relative inline-flex items-center px-4 py-2 text-sm font-semibold text-stone-900 ring-1 ring-inset ring-stone-300 hover:bg-stone-50 focus:z-20 focus:outline-offset-0">
                  {{ page }}
                </a>
              {% endif -%}
            {% endfor -%}

            {% if end_page < total_pages -%}
              {% if end_page < total_pages - 1 -%}
                <span class="relative inline-flex items-center px-4 py-2 text-sm font-semibold text-stone-700 ring-1 ring-inset ring-stone-300">...</span>
              {% endif -%}
              <a href="{{ base_url }}&page={{ total_pages }}"
                 hx-get="{{ base_url }}&page={{ total_pages }}"
                 hx-target="{{ hx_target }}"
                 hx-indicator="#dashboard-spinner"
                 class="relative inline-flex items-center px-4 py-2 text-sm font-semibold text-stone-900 ring-1 ring-inset ring-stone-300 hover:bg-stone-50 focus:z-20 focus:outline-offset-0">
                {{ total_pages }}
              </a>
            {% endif -%}

            {% if current_page < total_pages -%}
              <a href="{{ base_url }}&page={{ current_page + 1 }}"
                 hx-get="{{ base_url }}&page={{ current_page + 1 }}"
                 hx-target="{{ hx_target }}"
                 hx-indicator="#dashboard-spinner"
                 class="relative inline-flex items-center rounded-r-md px-2 py-2 text-stone-400 ring-1 ring-inset ring-stone-300 hover:bg-stone-50 focus:z-20 focus:outline-offset-0">
                <span class="sr-only">Next</span>
                <svg class="h-5 w-5" viewBox="0 0 20 20" fill="currentColor" aria-hidden="true">
                  <path fill-rule="evenodd" d="M7.21 14.77a.75.75 0 01.02-1.06L11.168 10 7.23 6.29a.75.75 0 111.04-1.08l4.5 4.25a.75.75 0 010 1.08l-4.5 4.25a.75.75 0 01-1.06-.02z" clip-rule="evenodd" />
                </svg>
              </a>
            {% else -%}
              <span class="relative inline-flex items-center rounded-r-md px-2 py-2 text-stone-300 ring-1 ring-inset ring-stone-200 bg-stone-50 cursor-not-allowed">
                <span class="sr-only">Next</span>
                <svg class="h-5 w-5" viewBox="0 0 20 20" fill="currentColor" aria-hidden="true">
                  <path fill-rule="evenodd" d="M7.21 14.77a.75.75 0 01.02-1.06L11.168 10 7.23 6.29a.75.75 0 111.04-1.08l4.5 4.25a.75.75 0 010 1.08l-4.5 4.25a.75.75 0 01-1.06-.02z" clip-rule="evenodd" />
                </svg>
              </span>
            {% endif -%}
          </nav>
        </div>
      </div>
    </div>
  {% endif -%}
{% endmacro pagination -%}
{# End pagination controls #}
