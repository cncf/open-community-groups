{# Common badge -#}
{% macro common_badge(content, extra_styles = None) -%}
  {% let extra_styles_ = extra_styles.unwrap_or("") -%}

  <span class="custom-badge {{ extra_styles_ }}">{{ content }}</span>
{% endmacro common_badge -%}
{# End common badge -#}

{# Event badge -#}
{% macro event_badge(kind, canceled = false, extra_styles = None) -%}
  {% let extra_styles_ = extra_styles.unwrap_or("") -%}

  {% if canceled -%}
    <span class="custom-badge canceled {{ extra_styles_ }}">Canceled</span>
  {% else -%}
    {{ common_badge(content = kind, extra_styles = extra_styles) -}}
  {% endif -%}
{% endmacro event_badge -%}
{# End event badge -#}

{# Status badge -#}
{% macro status_badge(label, canceled = false, published = false, title = "", extra_styles = None) -%}
  {% let extra_styles_ = extra_styles.unwrap_or("") -%}

  {% if canceled -%}
    <span class="custom-badge bg-red-100 border-red-800 text-red-800 px-2.5 py-0.5 {{ extra_styles_ }}"
          {% if !title.is_empty() %}title="{{ title }}"{% endif %}>{{ label }}</span>
  {% else if published -%}
    <span class="custom-badge bg-green-100 border-green-800 text-green-800 px-2.5 py-0.5 {{ extra_styles_ }}"
          {% if !title.is_empty() %}title="{{ title }}"{% endif %}>{{ label }}</span>
  {% else -%}
    <span class="custom-badge bg-amber-100 border-amber-800 text-amber-800 px-2.5 py-0.5 {{ extra_styles_ }}"
          {% if !title.is_empty() %}title="{{ title }}"{% endif %}>{{ label }}</span>
  {% endif -%}
{% endmacro status_badge -%}
{# End status badge -#}

{# Submission status badge -#}
{% macro submission_status_badge(status_id, label, extra_styles = None) -%}
  {% let extra_styles_ = extra_styles.unwrap_or("") -%}

  {% if status_id == "not-reviewed" -%}
    {{ common_badge(content = label, extra_styles = extra_styles) -}}
  {% else if status_id == "approved" -%}
    <span class="custom-badge bg-green-100 border-green-800 text-green-800 px-2.5 py-0.5 {{ extra_styles_ }}">
      {{ label }}
    </span>
  {% else if status_id == "rejected" -%}
    <span class="custom-badge bg-red-100 border-red-800 text-red-800 px-2.5 py-0.5 {{ extra_styles_ }}">
      {{ label }}
    </span>
  {% else if status_id == "information-requested" -%}
    <span class="custom-badge bg-amber-100 border-amber-800 text-amber-800 px-2.5 py-0.5 {{ extra_styles_ }}">
      {{ label }}
    </span>
  {% else if status_id == "withdrawn" -%}
    <span class="custom-badge bg-stone-100 border-stone-500 text-stone-700 px-2.5 py-0.5 {{ extra_styles_ }}">
      {{ label }}
    </span>
  {% else -%}
    {{ common_badge(content = label, extra_styles = extra_styles) -}}
  {% endif -%}
{% endmacro submission_status_badge -%}
{# End submission status badge -#}

{# Submission action required icon badge styles -#}
{% macro submission_status_action_required_icon_button_styles(status_id) -%}
  {% if status_id == "approved" -%}
    border-green-800 bg-green-100
  {% else if status_id == "rejected" -%}
    border-red-800 bg-red-100
  {% else if status_id == "information-requested" -%}
    border-amber-800 bg-amber-100
  {% else if status_id == "withdrawn" -%}
    border-stone-500 bg-stone-100
  {% else -%}
    border-stone-200 bg-stone-100
  {% endif -%}
{% endmacro submission_status_action_required_icon_button_styles -%}
{# End submission action required icon badge styles -#}

{# Submission action required icon styles -#}
{% macro submission_status_action_required_icon_styles(status_id) -%}
  {% if status_id == "approved" -%}
    bg-green-800
  {% else if status_id == "rejected" -%}
    bg-red-800
  {% else if status_id == "information-requested" -%}
    bg-amber-800
  {% else if status_id == "withdrawn" -%}
    bg-stone-700
  {% else -%}
    bg-stone-500
  {% endif -%}
{% endmacro submission_status_action_required_icon_styles -%}
{# End submission action required icon styles -#}

{# Submission status with action required indicator -#}
{% macro submission_status_with_action_required(status_id, label, action_required_message, extra_styles = None) -%}
  <div class="inline-flex items-center gap-2">
    {{ submission_status_badge(status_id = status_id.to_string() , label = label, extra_styles = extra_styles) -}}
    {% if let Some(message) = &action_required_message -%}
      <span class="relative inline-flex">
        <button type="button"
                class="inline-flex items-center justify-center size-5 border rounded-full {{ submission_status_action_required_icon_button_styles(status_id = status_id.to_string() ) }}"
                data-action="open-action-required-modal"
                data-action-required-message="{{ message }}"
                aria-label="View action required details">
          <div class="svg-icon size-2.5 icon-info {{ submission_status_action_required_icon_styles(status_id = status_id.to_string() ) }}">
          </div>
        </button>
      </span>
    {% endif -%}
  </div>
{% endmacro submission_status_with_action_required -%}
{# End submission status with action required indicator -#}

{# CFS label chip -#}
{% macro cfs_label_chip(name, color, extra_styles = None) -%}
  {% let extra_styles_ = extra_styles.unwrap_or("") -%}

  <span class="inline-flex items-center rounded-full border px-2 py-0.5 text-[11px] font-medium text-stone-900 {{ extra_styles_ }}"
        style="--label-color: {{ color }};
               border-color: var(--label-color);
               background-color: color-mix(in srgb, var(--label-color) 30%, transparent)">{{ name }}</span>
{% endmacro cfs_label_chip -%}
{# End CFS label chip -#}

{# Sold out overlay badge -#}
{% macro sold_out_overlay(remaining_capacity, capacity = None, outer_classes = None, inner_classes = None, label = "Sold out", orientation = "top-left") -%}
  {% let outer_classes_ = outer_classes.unwrap_or("") -%}
  {% let inner_classes_ = inner_classes.unwrap_or("") -%}
  {% let orientation_ = orientation.to_string() -%}

  {% if let Some(capacity_) = &capacity -%}
    {% if *capacity_ > 0 -%}
      {% if let Some(remaining_capacity_) = &remaining_capacity -%}
        {% if *remaining_capacity_ == 0 -%}
          <div class="absolute overflow-hidden inset-0 {{ outer_classes_ }}">
            <div class="pointer-events-none absolute z-10 w-20 md:w-25 {{ inner_classes_ }}">
              <span class="block bg-red-500/90 text-white text-shadow-xs text-[0.45rem]/4 md:text-[0.6rem]/5 font-bold uppercase tracking-widest text-center text-nowrap shadow-md transform
                           {% if orientation_ == "top-right" -%}
                             rotate-45 origin-top-right
                           {% else -%}
                             -rotate-45 origin-top-left
                           {% endif -%}
                           caps">{{ label }}</span>
            </div>
          </div>
        {% endif -%}
      {% endif -%}
    {% endif -%}
  {% endif -%}
{% endmacro sold_out_overlay -%}
{# End sold out overlay badge -#}

{# Sponsor badge -#}
{% macro sponsor_badge(name, logo_url, website_url, level = "", with_level = false) -%}
  {% if let Some(website_url) = &website_url -%}
    <a href="{{ website_url }}"
       target="_blank"
       rel="noopener noreferrer"
       class="inline-flex items-center gap-3 rounded-xl border border-stone-200 bg-white p-4 w-full focus:outline-none focus-visible:ring-2 focus-visible:ring-primary-500">
    {% else -%}
      <div class="inline-flex items-center gap-3 rounded-xl border border-stone-200 bg-white p-4 w-full">
      {% endif -%}
      <div class="relative flex items-center justify-center size-15 md:size-18 shrink-0 rounded-lg bg-white border border-stone-200 overflow-hidden">
        <img src="{{ logo_url }}"
             alt="{{ name }} logo"
             class="size-13 md:size-16 object-contain"
             width="auto"
             height="auto"
             loading="lazy" />
        <div class="fallback-icon hidden absolute inset-0 flex items-center justify-center">
          <div class="svg-icon size-6 bg-amber-500 icon-handshake"></div>
        </div>
      </div>
      <div class="leading-tight min-w-0">
        <div class="text-sm md:text-base font-semibold text-stone-900 truncate">{{ name }}</div>
        {% if with_level -%}
          <div class="text-xs uppercase tracking-wide text-stone-600 truncate mt-1.5">{{ level }}</div>
        {% endif -%}
      </div>
      {% if let Some(website_url) = &website_url -%}
      </a>
    {% else -%}
    </div>
  {% endif -%}
{% endmacro sponsor_badge -%}
{# End sponsor badge -#}
